

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>APIC Process Crash Troubleshooting &mdash; ACI Troubleshooting Book 0.0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="ACI Troubleshooting Book 0.0.1 documentation" href="index.html"/>
        <link rel="next" title="Appendix" href="appendix.html"/>
        <link rel="prev" title="ACI Fabric Node and Process Crash Troubleshooting" href="fn_crash_ts.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> ACI Troubleshooting Book</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="preface.html#authors-and-contributors">Authors and Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#distinguished-contributors">Distinguished Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#dedications">Dedications</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#acknowledgments">Acknowledgments</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#book-writing-methodology">Book Writing Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#who-should-read-this-book">Who Should Read This Book?</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#organization-of-this-book">Organization of this Book</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aci.html">Application Centric Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="aci_policy_model.html">ACI Policy Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#abstraction-model">Abstraction Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#everything-is-an-object">Everything is an Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#relevant-objects-and-relationships">Relevant Objects and Relationships</a></li>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#hierarchical-aci-object-model-and-the-infrastructure">Hierarchical ACI Object Model and the Infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#infrastructure-as-objects">Infrastructure as Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#build-object-use-object-to-build-policy-reuse-policy">Build object, use object to build policy, reuse policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#rest-api-just-exposes-the-object-model">REST API just exposes the object model</a></li>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#logical-model-resolved-model-concrete-model">Logical model, Resolved model, concrete model</a></li>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#formed-and-unformed-relationships">Formed and Unformed Relationships</a></li>
<li class="toctree-l2"><a class="reference internal" href="aci_policy_model.html#declarative-end-state-and-promise-theory">Declarative End State and Promise Theory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Troubleshooting Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tools.html#apic-access-methods">APIC Access Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#programmatic-configuration-python">Programmatic Configuration (Python)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#fabric-node-access-methods">Fabric Node Access Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#exporting-information-from-the-fabric">Exporting information from the Fabric</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#external-data-collection-syslog-snmp-call-home">External Data Collection – Syslog, SNMP, Call-Home</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#health-scores">Health Scores</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html#atomic-counters">Atomic Counters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ts_methodology.html">Troubleshooting Methodology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ts_methodology.html#overall-methodology">Overall Methodology</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="topology.html">Sample Reference Topology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="topology.html#physical-fabric-topology">Physical Fabric Topology</a></li>
<li class="toctree-l2"><a class="reference internal" href="topology.html#logical-application-topology">Logical Application Topology</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#naming-conventions">Naming Conventions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hw_bringup.html">Initial Hardware Bringup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hw_bringup.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="hw_bringup.html#problem-description">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="hw_bringup.html#id2">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fabric_init.html">Fabric Initialization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fabric_init.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="fabric_init.html#fabric-verification">Fabric Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="fabric_init.html#problem-description">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="apic.html">Application Policy Infrastructure Controller (APIC) High Availability and Clustering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="apic.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="apic.html#cluster-formation">Cluster Formation</a></li>
<li class="toctree-l2"><a class="reference internal" href="apic.html#majority-and-minority-handling-clustering-split-brains">Majority and Minority - Handling Clustering Split Brains</a></li>
<li class="toctree-l2"><a class="reference internal" href="apic.html#problem-description">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="apic.html#id1">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="apic.html#id4">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="apic.html#id6">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="apic.html#id9">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="apic.html#id12">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="apic.html#id15">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="firmware.html">Firmware and Image Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="firmware.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="firmware.html#problem-description">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="firmware.html#id1">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="firmware.html#id5">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="health.html">Faults / Health Scores</a><ul>
<li class="toctree-l2"><a class="reference internal" href="health.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="health.html#problem-description">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="health.html#id1">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rest.html">REST Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rest.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="rest.html#problem-description">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mgmt_tn.html">Management Tenant</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mgmt_tn.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgmt_tn.html#problem-description">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="mgmt_tn.html#id1">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Network Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="common.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="common.html#problem-description">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="common.html#id15">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="unicast.html">Unicast Data Plane Forwarding and Reachability</a><ul>
<li class="toctree-l2"><a class="reference internal" href="unicast.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicast.html#problem-description">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="unicast.html#id1">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pol_cntr.html">Policies and Contracts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pol_cntr.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="pol_cntr.html#problem-description">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bridged2ext.html">Bridged Connectivity to External Networks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="bridged2ext.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridged2ext.html#problem-description">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridged2ext.html#id3">Problem Description:</a></li>
<li class="toctree-l2"><a class="reference internal" href="bridged2ext.html#id5">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="routed2ext.html">Routed Connectivity to External Networks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="routed2ext.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="routed2ext.html#fabric-verification">Fabric Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="routed2ext.html#problem-description">Problem description</a></li>
<li class="toctree-l2"><a class="reference internal" href="routed2ext.html#id1">Problem description</a></li>
<li class="toctree-l2"><a class="reference internal" href="routed2ext.html#id3">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vmm_ucs.html">Virtual Machine Manager and UCS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vmm_ucs.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="vmm_ucs.html#problem-description">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="vmm_ucs.html#id2">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="vmm_ucs.html#id6">Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="vmm_ucs.html#id9">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="l4l7.html">L4-L7 Service Insertion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="l4l7.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="l4l7.html#problem-description">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fn_crash_ts.html">ACI Fabric Node and Process Crash Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fn_crash_ts.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="fn_crash_ts.html#problem-description">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">APIC Process Crash Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#problem-description">Problem Description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="appendix.html#overview">Overview</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">ACI Troubleshooting Book</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div></div>
          <div role="main" class="document">
            
  <div class="section" id="apic-process-crash-troubleshooting">
<h1>APIC Process Crash Troubleshooting<a class="headerlink" href="#apic-process-crash-troubleshooting" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#overview" id="id5">Overview</a><ul>
<li><a class="reference internal" href="#dme-processes" id="id6">DME Processes:</a></li>
<li><a class="reference internal" href="#how-to-identify-when-a-process-crashes" id="id7">How to Identify When a Process Crashes:</a></li>
<li><a class="reference internal" href="#collecting-the-core-files" id="id8">Collecting the Core Files:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#problem-description" id="id9">Problem Description</a><ul>
<li><a class="reference internal" href="#symptom-1" id="id10">Symptom 1</a></li>
<li><a class="reference internal" href="#verification" id="id11">Verification</a><ul>
<li><a class="reference internal" href="#check-the-appropriate-process-log" id="id12">Check the appropriate process log:</a></li>
<li><a class="reference internal" href="#check-what-activity-occurred-at-the-time-of-the-process-crash" id="id13">Check what activity occurred at the time of the process crash</a></li>
<li><a class="reference internal" href="#restarting-a-process" id="id14">Restarting a process:</a></li>
<li><a class="reference internal" href="#collect-techsupport-and-core-file-and-contact-the-cisco-tac" id="id15">Collect Techsupport and Core File and Contact the Cisco TAC:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#symptom-2" id="id16">Symptom 2</a></li>
<li><a class="reference internal" href="#id1" id="id17">Verification</a><ul>
<li><a class="reference internal" href="#id2" id="id18">Check the appropriate process log:</a></li>
<li><a class="reference internal" href="#id3" id="id19">Check what activity occurred at the time of the process crash:</a></li>
<li><a class="reference internal" href="#id4" id="id20">Collect Techsupport and Core File and Contact the Cisco TAC:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id5">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The APIC has a series of Data Management Engine (DME) processes which control
various functional aspects on the system. When the system has a software
failure in a particular process, a core file will be generated and the process
will be reloaded.</p>
<p>This chapter covers potential issues involving system processes crashes or
software failures, beginning with an overview of the various system processes,
how to detect that a process has cored, and what actions should be taken when
this occurs. The displays taken on a working healthy system can then be used
to identify processes that may have terminated abruptly.</p>
<div class="section" id="dme-processes">
<h3><a class="toc-backref" href="#id6">DME Processes:</a><a class="headerlink" href="#dme-processes" title="Permalink to this headline">¶</a></h3>
<p>The essential processes running on an APIC can be found either through the GUI
or the CLI. Using the GUI, the processes and the process ID running is found
in System-&gt;Controllers-&gt;Processes as shown here:</p>
<a class="reference internal image-reference" href="_images/ScreenShot2014-10-14at3.55.04PM.png"><img alt="_images/ScreenShot2014-10-14at3.55.04PM.png" class="align-center" src="_images/ScreenShot2014-10-14at3.55.04PM.png" style="width: 750px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Using the CLI, the processes and the process ID are found in the <strong>summary</strong>
file at <strong>/aci/system/controllers/1/processes</strong> (for APIC1):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">admin@RTP_Apic1:processes&gt; cat summary</span>
<span class="go">processes:</span>
<span class="go">process-id  process-name       max-memory-allocated  state</span>
<span class="go">----------  -----------------  --------------------  -------------------</span>
<span class="go">0           KERNEL             0                     interruptible-sleep</span>
<span class="go">331         dhcpd              108920832             interruptible-sleep</span>
<span class="go">336         vmmmgr             334442496             interruptible-sleep</span>
<span class="go">554         neo                398274560             interruptible-sleep</span>
<span class="go">1034        ae                 153690112             interruptible-sleep</span>
<span class="go">1214        eventmgr           514793472             interruptible-sleep</span>
<span class="go">2541        bootmgr            292020224             interruptible-sleep</span>
<span class="go">4390        snoopy             28499968              interruptible-sleep</span>
<span class="go">5832        scripthandler      254308352             interruptible-sleep</span>
<span class="go">19204       dbgr               648941568             interruptible-sleep</span>
<span class="go">21863       nginx              4312199168            interruptible-sleep</span>
<span class="go">32192       appliancedirector  136732672             interruptible-sleep</span>
<span class="go">32197       sshd               1228800               interruptible-sleep</span>
<span class="go">32202       perfwatch          19345408              interruptible-sleep</span>
<span class="go">32203       observer           724484096             interruptible-sleep</span>
<span class="go">32205       lldpad             1200128               interruptible-sleep</span>
<span class="go">32209       topomgr            280576000             interruptible-sleep</span>
<span class="go">32210       xinetd             99258368              interruptible-sleep</span>
<span class="go">32213       policymgr          673251328             interruptible-sleep</span>
<span class="go">32215       reader             258940928             interruptible-sleep</span>
<span class="go">32216       logwatch           266596352             interruptible-sleep</span>
<span class="go">32218       idmgr              246824960             interruptible-sleep</span>
<span class="go">32416       keyhole            15233024              interruptible-sleep</span>
<span class="go">admin@apic1:processes&gt;</span>
</pre></div>
</div>
<p>Each of the processes running on the APIC writes to a log file on the system.
These log files can be bundled as part of the APIC techsupport file but can
also be observed through SSH shell access in <strong>/var/log/dme/log</strong>. For example,
the Policy Manager process log output is written into
<strong>/var/log/dme/log/svc_ifc_policymgr.bin.log</strong>.</p>
<p>The following is a brief description of the processes running on the system.
This can help in understanding which log files to reference when
troubleshooting a particular process or understand the impact to the system if
a process crashed:</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Process</th>
<th class="head">Function</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>KERNEL</td>
<td>Linux kernel</td>
</tr>
<tr class="row-odd"><td>dhcpd</td>
<td>DHCP process running for APIC to assign infra addresses</td>
</tr>
<tr class="row-even"><td>vmmmgr</td>
<td>Handles process between APIC and Hypervisors</td>
</tr>
<tr class="row-odd"><td>neo</td>
<td>Shell CLI Interpreter</td>
</tr>
<tr class="row-even"><td>ae</td>
<td>Handles the state and inventory of local APIC appliance</td>
</tr>
<tr class="row-odd"><td>eventmgr</td>
<td>Handles all events and faults on the system</td>
</tr>
<tr class="row-even"><td>bootmgr</td>
<td>Controls boot and firmware updates on fabric nodes</td>
</tr>
<tr class="row-odd"><td>snoopy</td>
<td>Shell CLI help, tab command completion</td>
</tr>
<tr class="row-even"><td>scripthandler</td>
<td>Handles the L4-L7 device scripts and communication</td>
</tr>
<tr class="row-odd"><td>dbgr Generates</td>
<td>core files when process crashes</td>
</tr>
<tr class="row-even"><td>nginx</td>
<td>Web service handling GUI and REST API access</td>
</tr>
<tr class="row-odd"><td>appliancedirector</td>
<td>Handles formation and control of APIC cluster</td>
</tr>
<tr class="row-even"><td>sshd</td>
<td>Enabled SSH access into the APIC</td>
</tr>
<tr class="row-odd"><td>perfwatch</td>
<td>Monitors Linux cgroup resource usage</td>
</tr>
<tr class="row-even"><td>observer</td>
<td>Monitors the fabric system and data handling of state,
stats, health</td>
</tr>
<tr class="row-odd"><td>lldpad</td>
<td>LLDP Agent</td>
</tr>
<tr class="row-even"><td>topomgr</td>
<td>Maintains fabric topology and inventory</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="how-to-identify-when-a-process-crashes">
<h3><a class="toc-backref" href="#id7">How to Identify When a Process Crashes:</a><a class="headerlink" href="#how-to-identify-when-a-process-crashes" title="Permalink to this headline">¶</a></h3>
<p>When a process crashes and a core file is generated, the ACI system raises a
fault notification and generates an entry in the event logs. The fault for the
particular process is shown as a &#8220;process-crash&#8221; as shown in this syslog
output from the APIC:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">Oct 15 17:13:35 apic1 %LOG_LOCAL7-3-SYSTEM_MSG [E4208395][process-crash][major][subj-[dbgs/cores/ctrlr-1-svc-reader-ts-2014-10-15T17:13:28.000+00:00]/rec-4294972278]Process reader cored</span>
</pre></div>
</div>
<p>The fault that is generated when the process crashes is cleared when the
process is restarted. The fault can be viewed via the GUI in the fabric
HISTORY-&gt; EVENTS tab at FABRIC-&gt;INVENTORY-&gt;Pod 1:</p>
<a class="reference internal image-reference" href="_images/process_crash.png"><img alt="_images/process_crash.png" class="align-center" src="_images/process_crash.png" style="width: 750px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="collecting-the-core-files">
<h3><a class="toc-backref" href="#id8">Collecting the Core Files:</a><a class="headerlink" href="#collecting-the-core-files" title="Permalink to this headline">¶</a></h3>
<p>The APIC GUI provides a central location to collect the core files for APICS
and nodes in the fabric.</p>
<p>An export policy can be created from ADMIN -&gt; IMPORT/EXPORT in Export Policies
-&gt; Core. However, there is a default core policy where files can be downloaded
directly. As shown in this example in the OPERATIONAL tab:</p>
<a class="reference internal image-reference" href="_images/core_file.jpg"><img alt="_images/core_file.jpg" class="align-center" src="_images/core_file.jpg" style="width: 750px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The core files can be accessed via SSH/SCP on the APIC at /data/techsupport.</p>
<p>Note that the core file will be available at /data/techsupport for the APIC
that had the process crash. Which APIC that the core file resides can be found
by the Export Location path as shown in the GUI. For example, if the Export
Location begins with &#8220;files/2/&#8221;, the file is located on node 2 (APIC2).</p>
</div>
</div>
<div class="section" id="problem-description">
<h2><a class="toc-backref" href="#id9">Problem Description</a><a class="headerlink" href="#problem-description" title="Permalink to this headline">¶</a></h2>
<p>APIC process crashes and either restarts automatically or is not running.</p>
<div class="section" id="symptom-1">
<h3><a class="toc-backref" href="#id10">Symptom 1</a><a class="headerlink" href="#symptom-1" title="Permalink to this headline">¶</a></h3>
<p>APIC process is not running</p>
</div>
<div class="section" id="verification">
<h3><a class="toc-backref" href="#id11">Verification</a><a class="headerlink" href="#verification" title="Permalink to this headline">¶</a></h3>
<p>A process that crashes generally should restart. However, if the same process
crashes several times in a short amount of time, the process may not recover.</p>
<p>Verify the process status through:</p>
<p>APIC CLI: Verify the contents of the <strong>summary</strong> file on the APIC located in
<strong>/aci/system/controllers/&lt;APIC node ID&gt;/processes</strong>. For example
/aci/system/controllers/1/processes/summary for APIC1. An example output was
shown in the above overview section.</p>
<p>GUI by navigating to SYSTEM-&gt;CONTROLLERS-&gt;Controllers and the APIC and check
that the processes running have a PID associated. All but KERNEL should. An
example output was shown in the above overview section.</p>
<div class="section" id="check-the-appropriate-process-log">
<h4><a class="toc-backref" href="#id12">Check the appropriate process log:</a><a class="headerlink" href="#check-the-appropriate-process-log" title="Permalink to this headline">¶</a></h4>
<p>The process which is not running should have at some level of log output prior
to the crash. The output of the logs for that APIC that the process is not
running is found in <strong>/var/log/dme/log</strong> via SSH access. The process name will
be part of the file name. For example vmmmgr is svc_ifc_vmmmgr.bin.log.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">admin@RTP_Apic1:log&gt; ls -l |grep vmmmgr</span>
<span class="go">-rw-r--r-- 2 ifc  root 18529370 Oct 15 14:38 svc_ifc_vmmmgr.bin.log</span>
<span class="go">-rw-r--r-- 1 ifc  root  1318921 Oct 14 19:25 svc_ifc_vmmmgr.bin.log.1.gz</span>
<span class="go">-rw-r--r-- 1 ifc  root   967890 Oct 14 19:42 svc_ifc_vmmmgr.bin.log.2.gz</span>
<span class="go">-rw-r--r-- 1 ifc  root  1555562 Oct 14 22:11 svc_ifc_vmmmgr.bin.log.3.gz</span>
<span class="go">-rw-r--r-- 1 ifc  root  1673143 Oct 15 12:19 svc_ifc_vmmmgr.bin.log.4.gz</span>
<span class="go">-rw-r--r-- 1 ifc  root  1119380 Oct 15 12:30 svc_ifc_vmmmgr.bin.log.5.gz</span>
<span class="go">-rw-r--r-- 2 ifc  root 18529370 Oct 15 14:38 svc_ifc_vmmmgr.bin.log.6</span>
<span class="go">-rw-r--r-- 1 ifc  root        2 Oct 14 13:36 svc_ifc_vmmmgr.bin.log.PRESERVED</span>
<span class="go">-rw-r--r-- 1 ifc  root     7924 Oct 14 22:44 svc_ifc_vmmmgr.bin.log.stderr</span>
<span class="go">admin@RTP_Apic1:log&gt;</span>
</pre></div>
</div>
<p>There will be several files for each process located at /var/log/dme/log. As
the log file increases in size, it will be compressed and older log files will
be rotated off. Check the core file creation time (as shown in the GUI and the
core file name) to understand where to look in the file. Also, when the
process first attempts to come up, there exists an entry in the log file that
indicates &#8220;Process is restarting after a crash&#8221; that can be used to search
backwards as to what might have happened prior to the crash.</p>
</div>
<div class="section" id="check-what-activity-occurred-at-the-time-of-the-process-crash">
<h4><a class="toc-backref" href="#id13">Check what activity occurred at the time of the process crash</a><a class="headerlink" href="#check-what-activity-occurred-at-the-time-of-the-process-crash" title="Permalink to this headline">¶</a></h4>
<p>Typically, a process which has been running successfully would have to
experience some change which caused it to crash. In many cases the changes may
have been some configuration activity on the system. What activity occurred on
the system can be found in the audit log history of the system.</p>
<p>For example, if the policymgr process crashes several times that led to the
process not being up, going into the logs and inspecting entries around the
time of the first crash is a good way to investigate what might have caused
the issue. As shown in the example below, there was a change where a new
service graph was added, thus giving the indication that the service graph
configuration may have caused the failure:</p>
<a class="reference internal image-reference" href="_images/policymgr_core.png"><img alt="_images/policymgr_core.png" class="align-center" src="_images/policymgr_core.png" style="width: 750px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="restarting-a-process">
<h4><a class="toc-backref" href="#id14">Restarting a process:</a><a class="headerlink" href="#restarting-a-process" title="Permalink to this headline">¶</a></h4>
<p>When a process fails to restart automatically on an APIC, the recommended
method is to restart the APIC to allow all the processes to come up
organically.</p>
<p>The processes can be started as well through the APIC shell command <strong>acidiag
restart mgmt</strong>. This will restart the essential APIC processes but it will cause
all processes to restart, not just bringing up the process which is not
running.</p>
<p>Now, if the process has crashed several times already, the process may crash
again when it comes up. This could be to some persistent condition of
configuration that is leading to the crash. Knowing what changed as indicated
above may help to know what corrective actions to take to correct the root
issue.</p>
</div>
<div class="section" id="collect-techsupport-and-core-file-and-contact-the-cisco-tac">
<h4><a class="toc-backref" href="#id15">Collect Techsupport and Core File and Contact the Cisco TAC:</a><a class="headerlink" href="#collect-techsupport-and-core-file-and-contact-the-cisco-tac" title="Permalink to this headline">¶</a></h4>
<p>Process crashes should not occur under normal operational conditions. In order
to understand better why the process crashed beyond the above steps it will be
necessary to decode the core files. At this point, the files will need to be
collected and provided to Cisco Technical Assistance Center for further
processing.</p>
<p>Collect the core files, as indicated above in the overview section, and open
up a support case with the Cisco Technical Assistance Center.</p>
</div>
</div>
<div class="section" id="symptom-2">
<h3><a class="toc-backref" href="#id16">Symptom 2</a><a class="headerlink" href="#symptom-2" title="Permalink to this headline">¶</a></h3>
<p>APIC process has crashed and restarted automatically</p>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id17">Verification</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>A process that crashes generally should restart. When the process crashes, a
core file will be generated as indicated in the overview section.</p>
<div class="section" id="id2">
<h4><a class="toc-backref" href="#id18">Check the appropriate process log:</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>The process which crashes should have at some level of log output prior to the
crash. The output of the logs for that APIC that the process is not running is
found in <strong>/var/log/dme/log</strong> when logged in via SSH access. The process name will
be part of the file name. For example vmmmgr is svc_ifc_vmmmgr.bin.log.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">admin@RTP_Apic1:log&gt; ls -l |grep vmmmgr</span>
<span class="go">-rw-r--r-- 2 ifc  root 18529370 Oct 15 14:38 svc_ifc_vmmmgr.bin.log</span>
<span class="go">-rw-r--r-- 1 ifc  root  1318921 Oct 14 19:25 svc_ifc_vmmmgr.bin.log.1.gz</span>
<span class="go">-rw-r--r-- 1 ifc  root   967890 Oct 14 19:42 svc_ifc_vmmmgr.bin.log.2.gz</span>
<span class="go">-rw-r--r-- 1 ifc  root  1555562 Oct 14 22:11 svc_ifc_vmmmgr.bin.log.3.gz</span>
<span class="go">-rw-r--r-- 1 ifc  root  1673143 Oct 15 12:19 svc_ifc_vmmmgr.bin.log.4.gz</span>
<span class="go">-rw-r--r-- 1 ifc  root  1119380 Oct 15 12:30 svc_ifc_vmmmgr.bin.log.5.gz</span>
<span class="go">-rw-r--r-- 2 ifc  root 18529370 Oct 15 14:38 svc_ifc_vmmmgr.bin.log.6</span>
<span class="go">-rw-r--r-- 1 ifc  root        2 Oct 14 13:36 svc_ifc_vmmmgr.bin.log.PRESERVED</span>
<span class="go">-rw-r--r-- 1 ifc  root     7924 Oct 14 22:44 svc_ifc_vmmmgr.bin.log.stderr</span>
<span class="go">admin@RTP_Apic1:log&gt;</span>
</pre></div>
</div>
<p>There will be several files for each process located at /var/log/dme/log. As
the log file increases in size, it will be compressed and older log files will
be rotated off. Check the core file creation time (as shown in the GUI and the
core file name) to understand where to look in the file. Also, when the
process first attempts to come up, there be an entry in the log file that
indicates &#8220;Process is restarting after a crash&#8221; that can be used to search
backwards as to what might have happened prior to the crash.</p>
</div>
<div class="section" id="id3">
<h4><a class="toc-backref" href="#id19">Check what activity occurred at the time of the process crash:</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Typically, a process which has been running successfully would have to
experience some change which caused it to crash. In many cases the changes may
have been some configuration activity on the system. What activity occurred on
the system can be found in <strong>FABRIC-&gt;Pod 1</strong> in the <strong>HISTORY</strong> tab and then the
AUDIT LOG subtab.</p>
<p>In this example, the policymgr process crashed several times leading to the
process not being up. On further investigation, during the time of the first
crash event, a new service graph was added.</p>
<a class="reference internal image-reference" href="_images/policymgr_core.png"><img alt="_images/policymgr_core.png" class="align-center" src="_images/policymgr_core.png" style="width: 750px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="id4">
<h4><a class="toc-backref" href="#id20">Collect Techsupport and Core File and Contact the Cisco TAC:</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Process crashes should not occur under normal operational conditions. In order
to understand better why the process crashed beyond the above steps it will be
necessary to decode the core files. At this point, the files will need to be
collected and provided to Cisco Technical Assistance Center for further
processing.</p>
<p>Collect the core files, as indicated above in the overview section, and open
up a support case with the Cisco Technical Assistance Center.</p>
</div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="appendix.html" class="btn btn-neutral float-right" title="Appendix">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fn_crash_ts.html" class="btn btn-neutral" title="ACI Fabric Node and Process Crash Troubleshooting"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Andres Vega, Bryan Deaver, Jerry Ye, Kannan Ponnuswamy, Loy Evans, Mike Timm, Paul Lesiak and Paul Raytick.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60418502-1', 'auto');
    ga('send', 'pageview');

  </script>
   

</body>
</html>